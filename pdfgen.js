var pdflayercontent,temptable,dd;function getbase64(b){const c=b;var d=document.createElement("canvas");return d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0),d.toDataURL("image/png")}function pdfgen(b,c){pdflayercontent=[],layerindexes=[],Object.values(b).forEach(b=>{layerindexes.push(b.index)}),layerindexes.sort(function(c,a){return c-a}),Object.entries(b).forEach(d=>{const[e,b]=d;layertable=[],layertable[0]=[],layertable[0].push({text:"Layer: "+e,bold:!0,margin:[0,10,0,3],fontSize:11}),temptable={layout:"fixturetable",table:{headerRows:1,widths:[25,25,30,"*",130,70],body:[[{text:"Fix ID",style:"layerTableHeader"},{text:"Ch ID",style:"layerTableHeader"},{text:"Patch",style:"layerTableHeader"},{text:"Fixture Name",style:"layerTableHeader"},{text:"Fixture Type",style:"layerTableHeader"},{text:"Position (X|Y|Z)",style:"layerTableHeader"}]]},fontSize:9},tablebody=temptable.table.body,Object.entries(b.data).forEach(d=>{const[e,b]=d;tablebody.push([{text:b.FixtureID,alignment:"right"},{text:b.ChannelID,alignment:"right"},{text:b.Patch,alignment:"right"},{text:b.Name,alignment:"left"},{text:b.FixtureType,alignment:"left"},".xml"===/\.[^/.]+$/.exec(c)[0]&&null!==b.Position.x&&null!==b.Position.y&&null!==b.Position.z?{text:"( "+b.Position.x+" | "+b.Position.y+" | "+b.Position.z+" )",alignment:"left"}:""])}),layertable[0].push(temptable),pdflayercontent[layerindexes.indexOf(b.index)]=layertable}),dd={pageMargins:[60,110,60,50],header:function(){return[{columns:[{},{margin:[0,0,0,0],fit:[150,40],image:getbase64(document.getElementById("Logo")),alignment:"right"}],margin:[20,20,20,0]},{canvas:[{type:"line",x1:20,y1:10,x2:575,y2:10,lineWidth:1}]},{layout:"fileheader",table:{widths:["auto","auto","auto","*"],body:[[{text:"Show:",bold:!0},{text:c.replace(/\.[^/.]+$/,"")},{text:"Export Date:",bold:!0},{text:".xml"===/\.[^/.]+$/.exec(c)[0]?new Date(xmlDoc.getElementsByTagName("Info")[0].attributes.datetime.value).toLocaleString():new Date().toLocaleString()}]]},margin:[60,10,60,0],fontSize:11}]},footer:[{columns:[{},{margin:[0,30,30,0],text:[{text:"MA Patch to PDF",bold:!0},{text:" by Jannik Heym"}],fontSize:8,alignment:"right"}]}],content:[{layout:"layertable",margin:[0,0,0,0],table:{widths:["*"],body:pdflayercontent}}],styles:{layerTableHeader:{alignment:"left",color:"#ffffff"}}}}pdfMake.tableLayouts={fileheader:{vLineWidth:function(b){return 0!=b&&4!=b?0:1},paddingLeft:function(b){return 0===b?5:0},paddingRight:function(b){return 1===b||3===b?10:5}},fixturetable:{fillColor:function(b){return 0===b?"#707070":1==b%2?"#dedede":null}},layertable:{paddingLeft:function(){return 0},paddingRight:function(){return 0},paddingTop:function(){return 0},paddingBottom:function(){return 0},vLineWidth:function(){return 0},hLineWidth:function(){return 0}}};
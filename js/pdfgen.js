var pdflayercontent,dd;function getPerLayerConfig(){let a={};for(chkbx of document.querySelectorAll(".layerconfig input[type=checkbox]:checked"))"undefined"==typeof a[chkbx.name]&&(a[chkbx.name]=[]),a[chkbx.name].push(+chkbx.value);return a}function getbase64(a){const b=a;var c=document.createElement("canvas");return c.width=b.width,c.height=b.height,c.getContext("2d").drawImage(b,0,0),c.toDataURL("image/png")}function pdfgen(a,b){pdflayercontent=[],layerindexes=[],perlayerconfig=getPerLayerConfig(),Object.values(a.data).forEach(a=>{layerindexes.push(a.index)}),layerindexes.sort(function(c,a){return c-a}),Object.entries(a.data).forEach(a=>{const[c,d]=a;layertable=[],layertable[0]=[],layertable[0].push({text:"Layer: "+c,bold:!0,margin:0==layerindexes.indexOf(d.index)?[0,0,0,3]:[0,10,0,3],fontSize:11}),temptable={layout:"fixturetable",table:{headerRows:1,widths:[],body:[[]]},fontSize:9},perlayerconfig[c].forEach(a=>{element=defaultTableHeaders[a],temptable.table.widths.push(element.width),temptable.table.body[0].push({text:element.name,style:"layerTableHeader"})}),tablebody=temptable.table.body,Object.entries(d.data).forEach(a=>{const[d,e]=a;temptablebody=[],perlayerconfig[c].forEach(a=>{element=defaultTableHeaders[a],"undefined"!=typeof element.specialType&&"Position"===element.specialType?temptablebody.push((".xml"===/\.[^/.]+$/.exec(b)[0]||".json"===/\.[^/.]+$/.exec(b)[0])&&null!==e.Position.x&&null!==e.Position.y&&null!==e.Position.z?{text:"( "+e.Position.x+" | "+e.Position.y+" | "+e.Position.z+" )",alignment:element.valAlignment}:""):temptablebody.push({text:e[element.parserVar],alignment:element.valAlignment})}),tablebody.push(temptablebody)}),layertable[0].push(temptable),pdflayercontent[layerindexes.indexOf(d.index)]=layertable}),dd={info:{title:b.replace(/\.[^/.]+$/,""),author:"MA Patch to PDF by Jannik Heym"},pageMargins:[60,110,60,50],header:function(){return[{columns:[{text:"Patchplan",bold:!0,fontSize:25,margin:[40,5,0,0]},{margin:[0,0,0,0],fit:[150,40],image:getbase64(document.getElementById("Logo")),alignment:"right"}],margin:[20,20,20,0]},{canvas:[{type:"line",x1:20,y1:10,x2:575,y2:10,lineWidth:1}]},{layout:"fileheader",table:{widths:["auto","auto","auto","*"],body:[[{text:"Show:",bold:!0},{text:a.showname},{text:"Export Date:",bold:!0},{text:a.exportTime}]]},margin:[60,10,60,0],fontSize:11}]},footer:[{columns:[{},{margin:[0,30,30,0],text:[{text:"MA Patch to PDF",bold:!0},{text:" by Jannik Heym"}],fontSize:8,alignment:"right"}]}],content:[{layout:"layertable",margin:[0,0,0,0],table:{widths:["*"],body:pdflayercontent}}],styles:{layerTableHeader:{alignment:"left",color:"#ffffff"}}}}pdfMake.tableLayouts={fileheader:{vLineWidth:function(a){return 0!=a&&4!=a?0:1},paddingLeft:function(a){return 0===a?5:0},paddingRight:function(a){return 1===a||3===a?10:5}},fixturetable:{fillColor:function(a){return 0===a?"#707070":1==a%2?"#dedede":null}},layertable:{paddingLeft:function(){return 0},paddingRight:function(){return 0},paddingTop:function(){return 0},paddingBottom:function(){return 0},vLineWidth:function(){return 0},hLineWidth:function(){return 0}}};